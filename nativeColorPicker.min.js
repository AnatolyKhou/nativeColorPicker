(function(e){var c=e.document,d={started:!1,color:"#000000",inputs:{},hasNativeColorSupport:!1,init:function(a){this.start();if(!this.hasNativeColorSupport){if("string"!==typeof a)throw"inputId have to be a string id selector";this.input=this.inputs[a]=this.inputs[a]||c.getElementById(a);this.input.value=this.color;this.input.unselectable="on";this.css(this.input,{backgroundColor:this.color,borderWidth:"0.4em 0.3em",width:"3em",cursor:"default"});this.input.onfocus=function(){d.onFocus(this.id)}}},start:function(){if(!this.started){try{this.hasNativeColorSupport=!!(c.createElement("input").type="color")}catch(a){}if(!this.hasNativeColorSupport){var b=c.createElement("object");b.classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b";b.id="colorHelperObj";this.css(b,{width:"0",height:"0"});c.body.appendChild(b)}this.started=!0}},destroy:function(a){var b;if("string"===typeof a)this.off(this.inputs[a]);else{c.body.removeChild(c.getElementById("colorHelperObj"));for(b in this.inputs)this.off(this.inputs[b]);this.started=!1}},off:function(a){a.onfocus=null;this.css(a,{backgroundColor:"",borderWidth:"",width:"",cursor:""})},onFocus:function(a){this.input=this.inputs[a];this.color=this.getColor();this.input.value=this.color;d.css(this.input,{backgroundColor:this.color,color:this.color});this.input.blur()},getColor:function(){var a=colorHelperObj.ChooseColorDlg(this.color.replace(/#/,"")).toString(16);6>a.length&&(a="000000".substring(0,6-a.length).concat(a));return"#"+a},css:function(a,b){for(var c in b)a.style[c]=b[c]}};e.nativeColorPicker=d})(window);